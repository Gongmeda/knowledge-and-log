# Hexagonal Architecture

## 헥사고날 아키텍처란?

2005년 Alistair Cockburn이 제안한 아키텍처 패턴이다.

'Ports and Adapters 아키텍처' 라고도 불리는데, 이는 애플리케이션의 핵심 로직이 외부 세계와 '포트'라는 인터페이스를 통해 소통하고, 외부 기술은 '어댑터'를 통해 이 포트에 연결되는 구조적 특징을 표현한 것이다.

### 목적

> 애플리케이션이 사용자, 프로그램, 자동화된 테스트, 또는 배치 스크립트에 의해 동등하게 구동될 수 있도록 하고, 애플리케이션이 실행 시 사용될 장치나 데이터베이스로부터 격리된 상태에서 개발 및 테스트될 수 있도록 한다.

- UI나 데이터베이스 없이도 애플리케이션에 대한 자동화된 회귀 테스트를 실행할 수 있다.
- 데이터베이스를 사용할 수 없게 될 때도 작업을 계속할 수 있다.
- 사용자의 개입 없이 애플리케이션들을 서로 연결할 수 있다.

### 해결하는 문제

- **UI 코드로의 비즈니스 로직 침투**: 테스트해야 할 로직이 UI와 강결합되어 자동화된 테스트가 어려워지는 문제
- **외부 서비스에 묶이는 애플리케이션 로직**: 애플리케이션 로직이 외부 DB나 서비스에 묶이게 되면, DB가 다운되거나 크게 변경될 때 지연 비용이 큰 문제

> 외부 기술·UI와 분리된 도메인 중심 구조를 통해 애플리케이션을 쉽게 테스트하고, 컴포넌트 단위로 유연하게 교체·확장할 수 있도록 하는 접근

### 핵심 원칙과 구성 요소

전통적인 계층형 아키텍처(Layered Architecture)가 시스템을 표현(Presentation), 비즈니스(Business), 데이터 접근(Data Access) 등 상하(up-down) 계층으로 구분하는 반면, 헥사고날 아키텍처는 시스템을 다음과 같이 두 영역으로 나눈다.

- 내부 (Inside)
  - 순수한 비즈니스 로직과 도메인 규칙을 담고 있는 애플리케이션의 핵심부
  - 이 영역은 외부 세계의 그 어떤 기술에도 의존하지 않음
- 외부 (Outside)
  - UI, 데이터베이스, 외부 API, 메시지 큐 등 외부 세계와 상호작용하는 모든 기술적인 부분을 의미

이러한 구분은 비즈니스 로직이 데이터베이스 같은 하위 계층의 세부 구현에 의존하게 되는 계층형 아키텍처의 고질적인 문제를 근본적으로 방지한다.

<img width="330" height="330" alt="image" src="https://github.com/user-attachments/assets/213b9ff3-5a6b-45fa-9a55-a6ba6f96fc0a" />

> 애플리케이션은 '포트(Port)'를 통해 외부 에이전시와 통신하며, 각 포트에는 '어댑터(Adapter)'가 연결됨

**포트 (Port)**

- 애플리케이션이 외부 세계와 상호작용하기 위해 정의하는 인터페이스(API)
- 운영체제나 전자 기기의 포트처럼, 프로토콜을 준수하는 모든 장치가 연결될 수 있도록 하는 개념
- 특정 기술에 종속되지 않은 추상화된 규약
- 애플리케이션과의 유일한 통신 통로 역할

**어댑터 (Adapter)**

- 포트 인터페이스의 구체적인 구현체
- 외부 세계의 기술과 포트를 연결하는 접착제 역할
- 특정 기술(예: REST API 컨트롤러, DB 리포지토리)에 종속된 코드로 구성

**의존성 역전 원칙 (DIP)**

헥사고날 아키텍처의 가장 중요한 규칙은 의존성의 방향이다.

모든 의존성은 외부에서 내부를 향해야 하며, 그 반대는 절대 허용되지 않는다.

이를 '의존성 역전 원칙(Dependency Inversion Principle, DIP)'이라고 부르며, 이 원칙 덕분에 외부 기술이 변경되어도 애플리케이션은 전혀 영향을 받지 않게 된다.
